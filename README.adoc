= Reforum

== Goals

* Only one program needed (apart from Kratos), but can run multiple servers on same DB
* Kratos serves multiple websites with unified account
* Sea-ORM
* Data consistency in DB
* Sparse queries in DB

== Roadmap

* [ ] Version 1.0
** [x] Standalone authentication
*** [x] Login/logout/sessions
*** [ ] Registration/change password/recovery
** [x] Role based authorization
** [ ] CRUD
* [ ] Version 1.1
** [ ] HTML templates
** [ ] I18N
** [ ] Front page
** [ ] Pinned topics
* [ ] Version 1.2
** [ ] Finer-grained authorization
** [ ] Tags
** [ ] Search
** [ ] HTMX flow?
* [ ] Version 1.3
** [ ] Finer-grained moderation
* [ ] Version 2.0
** [ ] ORY Kratos
** [ ] Asciidoc

== User Story

=== Basic Interactions

=== Account Actions

* [ ] There is only one site administrator
* [ ] The user may wipe his/her account, deleting every topics/posts/replies from the database
** [ ] Optionally require moderator approval
** [ ] Moderators wiping their own account always require admin approval
** [ ] If user has been a moderator, this fact would persist in the `past_moderators` table
** [ ] Only the user himself/herself or the site administrator may wipe the account
** [ ] If the user has been a moderator and has modified others' content, the log persist as UID

=== Soft Deletion

* [ ] Topics and posts are never deleted from database, unless their authors' accounts are wiped
* [ ] Replies are actually deleted

=== Authentication

=== Authorization

=== Moderation

=== Administration

* [ ] Good tracing
** [x] Log all requests and response codes
** [x] Latency traces
* [ ] Rate limiting
** [ ] Intervals between posts
** [ ] Intervals between views

== Experience Report

=== Sea-ORM

* The migrations are quite unreadable
* The manual entity generation step is suboptimal
** I would prefer to generate migrations _from_ entities, not the other way around
* The automatic generation for SQLite gives wrong types
** `i32` instead of `i64`
** `String` instead of `DateTimeUtc`
** `INSERT ON CONFLICT` not supported for sqlite